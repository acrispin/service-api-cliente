<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.unicon.api.cliente.mapper.IClienteMapper">

    <!--@since 20191209 ACRISPIN | Mapper para clientes-->
    <resultMap id="selectClientesByNameMap" type="com.unicon.api.cliente.beans.ClienteBean">
        <result property="codigo" column="codigo"/>
        <result property="razonSocial" column="razonSocial"/>
        <result property="direccion" column="direccion"/>
        <result property="codigoPostal" column="codigoPostal"/>
        <result property="telefono" column="telefono"/>
        <result property="tipoCalle" column="tipoCalle"/>
        <result property="numeroCalle" column="numeroCalle"/>
        <result property="nombreUrbanizacion" column="nombreUrbanizacion"/>
        <result property="tipoDocumento" column="tipoDocumento"/>
        <result property="numeroDocumento" column="numeroDocumento"/>
    </resultMap>

    <select id="selectClientesByName" parameterType="java.util.Map" resultMap="selectClientesByNameMap">
        select top 100
            co_cli as codigo,
            no_cli as razonSocial,
            di_cli as direccion,
            co_pos_cli as codigoPostal,
            te_cli as telefono,
            ti_cal as tipoCalle,
            nu_cal as numeroCalle,
            no_urb as nombreUrbanizacion,
            ti_doc as tipoDocumento,
            nu_doc as numeroDocumento,
            apellidopaterno as apellidoPaterno,
            apellidomaterno as apellidoMaterno,
            nombres as nombre,
            co_aut_ven as codigoVendedor,
            es_cli as estado,
            fe_ing_cli
        from SQLCOP04.dbo.cli (nolock)
        order by fe_ing_cli desc
    </select>

    <!--@since 20191209 ACRISPIN | Mapper para clientes-->
    <resultMap id="selectResultTypeMap" type="com.unicon.api.cliente.beans.ResponseBean">
        <result property="estado" column="status"/>
        <result property="codigo" column="codigo"/>
        <result property="resultado" column="resultado"/>
        <result property="mensaje" column="mensaje"/>
    </resultMap>

    <!--@since 20191209 ACRISPIN | Mapper para clientes-->
    <select id="registrarCliente"
            parameterType="java.util.Map"
            resultMap="selectResultTypeMap">
        EXEC [api].[usp_registra_cliente]
            @v_co_cli = #{codigo},
            @rz_soc = #{razonSocial},
            @di_obr = #{direccion},
            @co_pos = #{codigoPostal},
            @te_cli = #{telefono},
            @ti_cal = #{tipoCalle},
            @nu_cal = #{numeroCalle},
            @no_urb = #{nombreUrbanizacion},
            @ti_doc = #{tipoDocumento},
            @nu_doc = #{numeroDocumento},
            @ap_pat = #{apellidoPaterno},
            @ap_mat = #{apellidoMaterno},
            @nombre = #{nombre},
            @cod_ve = #{codigoVendedor},
            @estado = #{estado},
            @co_ext = #{codigoExterno}
    </select>

    <!--@since 20191209 ACRISPIN | Mapper para clientes-->
    <resultMap id="selectResultTypeContactoMap" type="com.unicon.api.cliente.beans.ResponseContactoBean">
        <result property="codigoCliente" column="codigo_cliente"/>
        <result property="secuencia" column="secuencia"/>
        <result property="codigoUsuario" column="codigo_usuario"/>
        <result property="estado" column="status"/>
        <result property="resultado" column="resultado"/>
        <result property="mensaje" column="mensaje"/>
    </resultMap>

    <!--@since 20191209 ACRISPIN | Mapper para clientes-->
    <select id="registrarClienteContacto"
            parameterType="java.util.Map"
            resultMap="selectResultTypeContactoMap">
        EXEC [api].[usp_registra_cliente_contacto]
            @co_cli = #{codigoCliente},
            @v_se_rcl = #{secuencia},
            @nombre = #{nombre},
            @cargo = #{cargo},
            @tl = #{telefono},
            @tl2 = #{telefono2},
            @email = #{email},
            @dni = #{dni},
            @in_fact_elec = #{indicadorFacturacionElectronica},
            @aplld = #{apellido},
            @co_ext = #{codigoExterno},
            @estado = #{estado},
            @co_usu = #{codigoUsuario}
    </select>

</mapper>
